<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, target-densitydpi=medium-dpi, user-scalable=0" />
		<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
		<title>Social</title>
    </head>
    <body bgcolor="black">
		<!-----------------remove default margins------------------>
		<style type="text/css">
		
			body {
				margin: 0;
				padding: 0;
			}
		</style>
		<style>
			* {
				max-width: 100%;
			}
		</style>
		
		<!-----------------loading page----------------------------->
        <div id="king">
			<div id="deviceready">
				<p>Connecting To Device</p>
			</div>
		</div>
		
		<!------------------scripts--------------------------------->
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script>
		//===================globals================================
		var king = document.getElementById("king");
		var docWidth = (window.innerWidth > 0) ? window.innerWidth : screen.width;
		var docHeight= (window.innerHeight > 0) ? window.innerHeight : screen.height;
		var slider = docWidth*.07;
		var fontW = docWidth/25;
		
		//================device ready==============================
        app.initialize();
		
		var page={
		//===================login page=============================
			login: function(){
				$(window).trigger('resize');
				
				//signup div
				handleDOM.create("signup", "DIV", king);
				signup=document.getElementById("signup");
				
				signup.innerHTML="Sign Up Now";
				signup.style.position = "absolute";
				signup.style.textAlign = "center";
				signup.style.border = "thick solid #0000FF";
				signup.style.left=docWidth*.25 + "px";
				signup.style.top=docHeight*.55 +"px";
				signup.style.width=docWidth*.5 + "px";
				signup.style.height=docHeight*.3 + "px";
				
				signup.onclick=function(){
					handleDOM.remove("signup");
					handleDOM.remove("login");
					page.signup();
				}
				
				//login div
				handleDOM.create("login", "FORM", king);
				var login=document.getElementById("login");
				
				handleDOM.create("emailDIV", "DIV", login);
				var email=document.getElementById("emailDIV");
				email.innerHTML="ASU E-Mail:<br><input id='email' type='text' />";
				
				handleDOM.create("passwordDIV", "DIV", login);
				var password=document.getElementById("passwordDIV");
				password.innerHTML="Password:<br><input id='password' type='password' />";
			
				handleDOM.create("submit", "INPUT", login);
				var submit=document.getElementById("submit");
				submit.type="button";
				submit.value="Log In";
				submit.onclick=function(){
					var hr = new XMLHttpRequest();
					var url= "http://strugglingdev-games.com/login.php";
					var em = document.getElementById("email").value;
					var pw = document.getElementById("password").value;
					var vars = "email="+em.toLowerCase()+"&password="+pw;
					hr.open("POST", url, true);
					hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
					hr.onreadystatechange = function(){
						if(hr.readyState==4 && hr.status==200){
							var return_data=hr.responseText;
						}
						
						if(return_data=="1"){
							submit.value = "Success!";
							setTimeout(function(){
								handleDOM.remove("signup");
								handleDOM.remove("login");
								page.main(em, pw);
							}, 500);
						}
						else if(return_data=="2"){
							submit.value = "Success!";
							setTimeout(function(){
								handleDOM.remove("signup");
								handleDOM.remove("login");
								page.authenticate(em, pw);
							}, 500);
						}
						else if(return_data=="-1"){
							//invalid password
							submit.value = "Re-Submit";
						}
						else if(return_data==-"-2"){
							//email not found
							submit.value = "Re-Submit";
						}
						else if(return_data=="-3"){
							//network communication error
							submit.value = "Re-Submit";
						}
						else{
							//unkown error
							submit.value = "Re-Submit";
						}
					}
					hr.send(vars);
					
					submit.value = "authenticating...";
				};
				
				login.style.position = "absolute";
				login.style.textAlign = "center";
				login.style.border = "thick solid #0000FF";
				login.style.left=docWidth*.25 + "px";
				login.style.top=docHeight*.15 +"px";
				login.style.width=docWidth*.5 + "px";
				login.style.height=docHeight*.3 + "px";
			},
			
		//===================sign up page============================
			signup: function(){
				var validInput=false;
			
				handleDOM.create("signup", "FORM", king);
				var signup=document.getElementById("signup");
				
				handleDOM.create("emailDiv", "DIV", signup);
				var email=document.getElementById("emailDiv");
				email.innerHTML="ASU E-Mail: <input id='email' type='text' />";
				
				handleDOM.create("passwordDiv", "DIV", signup);
				var password=document.getElementById("passwordDiv");
				password.innerHTML="Password: <input id='password' type='password' /><br>Confirm: <input id='password2' type='password' />";
				
				handleDOM.create("submit", "INPUT", signup);
				var submit = document.getElementById("submit");
				submit.type="button";
				submit.value="Create Account";
				submit.onclick=function(){
					if(document.getElementById("password").value===document.getElementById("password2").value){
						validInput=true;
					}
					if(validInput){
						validInput=false;
						var hr = new XMLHttpRequest();
						var url= "http://strugglingdev-games.com/signup.php";
						var em = document.getElementById("email").value;
						var pw = document.getElementById("password2").value;
						var vars = "email="+em.toLowerCase()+"&password="+pw;
						hr.open("POST", url, true);
						hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
						hr.onreadystatechange = function(){
							if(hr.readyState==4 && hr.status==200){
								var return_data=hr.responseText;
								submit.value = return_data;
								if(return_data=="Thanks!"){
									setTimeout(function(){
										handleDOM.remove("submit");
										handleDOM.remove("passwordDiv");
										handleDOM.remove("emailDiv");
										handleDOM.remove("signup");
										page.authenticate(em, pw);
									}, 500);
								}
							}
						}
						hr.send(vars);
						submit.value = "processing...";
					}
				}
			},
		
		//==================validation page==========================
			authenticate: function(em, pw){
				handleDOM.create("validate", "FORM", king);
				var validate=document.getElementById("validate");
				
				handleDOM.create("codeDiv", "DIV", validate);
				var codeDIV=document.getElementById("codeDiv");
				codeDiv.innerHTML="Enter Validation Code:<br><input id='code' type='text' />";
				
				handleDOM.create("submit", "INPUT", validate);
				var submit=document.getElementById("submit");
				submit.type="button";
				submit.value="submit";
				submit.onclick=function(){
						var hr = new XMLHttpRequest();
						var url= "http://strugglingdev-games.com/authenticate.php";
						var code = document.getElementById("code").value;
						var vars = "code="+code+"&email="+em;
						hr.open("POST", url, true);
						hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
						hr.onreadystatechange = function(){
							if(hr.readyState==4 && hr.status==200){
								var return_data=hr.responseText;
								
								if(return_data=="1"){
									submit.value="Verified!";
									setTimeout(function(){
										handleDOM.remove("submit");
										handleDOM.remove("codeDiv");
										handleDOM.remove("validate");
										page.main(em, pw)
									},500);
								}
								else if(return_data=="2"){
									submit.value="Re-Submit";
								}
								else{
									alert("ERROR");
									submit.value="ERROR";
								}
							}
						}
						hr.send(vars);
						submit.value = "verifying...";
				}
			},
	
		//==================main page================================
			main: function(em, pw){
				//draw main screen
					//slide function
					var currentR=0;
					var currentL=docWidth;
					
					var slideRight = function(){
						setTimeout(function(){
							if(currentR<docWidth){
								currentR +=slider;
								if(currentR>.65*docWidth){
									profileImg.style.left=(1-picW)*docWidth+'px';
								}
								else{
									profileImg.style.left=currentR+'px';
								}
								dashboard.style.left=(picW*docWidth)+currentR+'px';
								search.style.left=(0.9*docWidth)+currentR+'px';
								feed.style.left=currentR+'px';
								slideRight();
							}
							else if(currentR >= docWidth){
								handleDOM.remove("title");
								handleDOM.remove("dashboard");
								
								handleDOM.remove("feed");
								
								page.circle(em, pw);
							}
						}, 20);
					}
					
					var slideLeft = function(){
						setTimeout(function(){
							if(currentL>0){
								currentL -=slider;
								if(docWidth-currentL<(.9*docWidth)){
									search.style.width=((docWidth-currentL)+(.1*docWidth))+'px';
									search.style.left=(currentL-(docWidth-(docWidth*.9)))+'px';
								}
								else{
									search.style.width=docWidth +'px';
									search.style.left=0+'px';
								}
								profileImg.style.left=(currentL-docWidth)+'px';
								dashboard.style.left=(currentL-(docWidth-(docWidth*picW)))+'px';
								feed.style.left=(currentL-docWidth)+'px';
								slideLeft();
							}
							else if(currentL <= 0){
								handleDOM.remove("profileImg");
								
								handleDOM.remove("title");
								handleDOM.remove("dashboard");
								
								handleDOM.remove("searchIcon");
								
								handleDOM.remove("feed");
								
								page.search(em, pw);
							}
						}, 20);
					}
					
					//create profile picture
					var picW=.225;
					handleDOM.create("profileImg", "IMG", king);
					var profileImg = document.getElementById("profileImg");
					profileImg.src="img/profile.jpg"
					profileImg.style.position="absolute";
					profileImg.style.left=0+'px';
					profileImg.style.top=0+'px';
					profileImg.style.width=picW*docWidth+'px';
					profileImg.style.height=picW*docWidth+'px';
					profileImg.onclick=function(){slideRight();};
					
					//create dashboard
					handleDOM.create("dashboard", "DIV", king);
					var dashboard = document.getElementById("dashboard");
					dashboard.style.position="absolute";
					dashboard.style.left=picW*docWidth+'px';
					dashboard.style.top=0+'px';
					dashboard.style.width=(.9-picW)*docWidth+'px';
					dashboard.style.height=picW*docWidth+'px';
					dashboard.style.backgroundColor = "#990033";
						//title
						handleDOM.create("title", "IMG", dashboard);
						var title=document.getElementById("title");
						title.src="img/title.png";
						title.style.position="relative";
						title.style.width=(.9-picW)*docWidth-(picW*.4*docWidth)+'px';
						title.style.left=picW*.2*docWidth+'px';
						title.style.height=(picW*.8*docWidth)/2+'px';
						title.style.top=picW*.05*docWidth+'px';
					
					//create search div
					handleDOM.create("search", "DIV", king);
					var search = document.getElementById("search");
					search.style.position="absolute";
					search.style.left=.9*docWidth+'px';
					search.style.top=0+'px';
					search.style.width=.1*docWidth+'px';
					search.style.height=picW*docWidth+'px';
					search.style.backgroundColor = "#990033";
						//search icon
						handleDOM.create("searchIcon", "IMG", search);
						var searchIcon=document.getElementById("searchIcon");
						searchIcon.src="img/search.png";
						searchIcon.style.position="relative";
						searchIcon.style.width=.1*docWidth+'px';
						searchIcon.style.height=(picW-.1)*docWidth+'px';
						searchIcon.style.top=((picW*docWidth)-(.1*docWidth))/2+'px';
						searchIcon.style.left=0+'px';
						searchIcon.onclick=function(){slideLeft()};
					
					//create feed
					handleDOM.create("feed", "DIV", king);
					var feed = document.getElementById("feed");
					feed.style.position="absolute";
					feed.style.left=0+'px';
					feed.style.top=picW*docWidth+'px';
					feed.style.width=docWidth+'px';
					feed.style.height=docHeight-(picW*docWidth)+'px';
					feed.style.backgroundColor = "black";
				
				//re-verify login credentials
			},
		
		//==================circles page=============================
			circle: function(em, pw){
				//draw main screen
					//slide function
				var current=docWidth;
				var slideLeft = function(){
					setTimeout(function(){
						if(current>0){
							current -=slider;
							if(current<=picW*docWidth){
								profileImg.style.left=0+'px';
							}
							else{
								profileImg.style.left=(current-(docWidth*picW))+'px';
							}
							banner.style.left=(current-(docWidth*.9))+'px';
							search.style.left=(current-docWidth)+'px';
							circles.style.left=(current-(docWidth))+'px';
							buttons.style.left=(current-(docWidth*picW))+'px';
							slideLeft();
						}
						else if(current <= 0){
							handleDOM.remove("settings");
							handleDOM.remove("newCircle");
							handleDOM.remove("newPic");
							handleDOM.remove("help");
							handleDOM.remove("buttons");
							
							handleDOM.remove("banner");
							
							handleDOM.remove("circles");
							page.main(em, pw);
						}
					}, 20);
				}
				var slideRight3 = function(){
					setTimeout(function(){
						if(current>=docWidth+(docWidth*picW)){
							handleDOM.remove("searchIcon");
							search.style.width=docWidth+'px';
							page.search(em, pw);
						}
						else{
							current+=slider/2;
							search.style.left=0+'px';
							search.style.width=current-(picW*docWidth)+'px';
							slideRight3();
						}
					}, 20);
				}
				
					//create picture
				var picW=.35;
				handleDOM.create("profileImg", "IMG", king);
				var profileImg=document.getElementById("profileImg");
				profileImg.style.position="fixed";
				profileImg.style.width=picW*docWidth+'px';
				profileImg.style.height=picW*docWidth+'px';
				profileImg.style.left=docWidth-(picW*docWidth)+'px';
				profileImg.onclick=function(){slideLeft();};
				
					//create circles
				handleDOM.create("circles", "DIV", king);
				var circles = document.getElementById("circles");
				circles.style.position="absolute";
				circles.style.width=docWidth-(picW*docWidth)-6+'px';
				circles.style.minHeight=docHeight-(docWidth*picW/2)+'px';
				circles.style.left=0+'px';
				circles.style.top=docWidth*picW/2+'px';
				circles.style.borderBottom="5px solid #990033";
				circles.style.borderRight="5px solid #990033";
				circles.style.backgroundColor="#A4A4A4";
						//retrieve group list data and display
					var n=100;
					for(var i=0; i<n; i++){
						handleDOM.create("circle"+i, "DIV", circles);
						var circle = document.getElementById("circle"+i);
						//constants
						circle.style.position="absolute";
						circle.style.width=(docWidth-(picW*docWidth)-5)*.9+'px';
						circle.style.height=((docWidth-(picW*docWidth)-5)*.9)/2.2+'px';
						circle.style.left=(docWidth-(picW*docWidth)-5)*.05-2+'px';
						circle.style.border="2px solid #990033";
						circle.style.backgroundColor="black";
						//variables
						circle.style.top=i*(((docWidth-(picW*docWidth)-5)*.9)/2.2)+(((docWidth-(picW*docWidth)-5)*.05-2)*2*(i+1))+'px';
					}
					circles.style.height=(n)*(((docWidth-(picW*docWidth)-5)*.9)/2.2)+(((docWidth-(picW*docWidth)-5)*.05-2)*2*(n+1))+'px';
					
		
					//header banner
				handleDOM.create("banner", "DIV", king);
				var banner = document.getElementById("banner");
				banner.style.position="fixed";
				banner.style.width=docWidth*.9-(picW*docWidth)-3+'px';
				banner.style.height=docWidth*picW/2+'px';
				banner.style.left=docWidth*.1+3+'px';
				banner.style.top=0+'px';
				banner.style.backgroundColor="#990033";
						//search my circles button
					handleDOM.create("searchCircles", "INPUT", banner);
					var searchCircles = document.getElementById("searchCircles");
					searchCircles.type="button";
					searchCircles.style.position="absolute";
					searchCircles.style.left=(docWidth*.9-(picW*docWidth)-3)*.1+'px';
					searchCircles.style.top=.1*docWidth*picW/2+'px';
					searchCircles.style.width=(docWidth*.9-(picW*docWidth)-3)*.8+'px';
					searchCircles.style.height=(docWidth*picW/2)*.8+'px';
					searchCircles.value="Search My Circles";
					searchCircles.style.color="#990033";
					searchCircles.style.border="3px solid #FBB310";
					searchCircles.style.backgroundColor="white";
					searchCircles.style.padding="8px";
					searchCircles.style.borderRadius=2*fontW+"px";
					searchCircles.style.fontSize=fontW+"px";
					searchCircles.style.fontWeight="bold";
					searchCircles.style.fontFamily="helvetica, serif";
					searchCircles.style.verticalAlign="middle";
					
					//delete and recreate search divs
				handleDOM.remove("searchIcon");
				handleDOM.remove("search");
				
				handleDOM.create("search", "DIV", king)
				var search = document.getElementById("search");
				search.style.position="fixed";
				search.style.height=docWidth*picW/2+'px';
				search.style.width=docWidth*.1+'px';
				search.style.top=0+'px';
				search.style.left=0+'px';
				search.style.borderRight="3px solid black";
				search.style.backgroundColor="#990033";
						//pull up search img
						handleDOM.create("searchIcon", "IMG", search);
						var searchIcon=document.getElementById("searchIcon");
						searchIcon.src="img/search.png";
						searchIcon.style.position="relative";
						searchIcon.style.width=.08*docWidth+'px';
						searchIcon.style.height=((picW/2)-.1)*docWidth +'px';
						searchIcon.style.left=.01*docWidth+'px';
						searchIcon.style.top=((docWidth*picW/2)-((picW/2)-.1)*docWidth)/2 +'px';
						searchIcon.onclick=function(){
							handleDOM.remove("banner");
							
							handleDOM.remove("profileImg");
							
							handleDOM.remove("newCircle");
							handleDOM.remove("settings");
							handleDOM.remove("newPic");
							handleDOM.remove("help");
							handleDOM.remove("buttons");
							
							handleDOM.remove("circles");
							
							search.style.position="absolute";
							slideRight3();
						};
					
					//create buttons
				handleDOM.create("buttons", "DIV", king);
				var buttons = document.getElementById("buttons");
				buttons.style.position="fixed";
				buttons.style.width=(picW*docWidth)+'px';
				buttons.style.height=docHeight-(picW*docWidth)+'px';
				buttons.style.left=docWidth-(docWidth*picW)+'px';
				buttons.style.top=(docWidth*picW)+'px';
				buttons.style.backgroundColor="black";
						
						//create circle button
						handleDOM.create("newCircle", "IMG", buttons);
						var newCircle=document.getElementById("newCircle");
						newCircle.src="img/newCircle.png";
						newCircle.style.position="absolute";
						
						//settings button
						handleDOM.create("settings", "IMG", buttons);
						var settings=document.getElementById("settings");
						settings.src="img/settings.png";
						settings.style.position="absolute";
						
						//change profile picture button
						handleDOM.create("newPic", "IMG", buttons);
						var newPic=document.getElementById("newPic");
						newPic.src="img/newPic.png";
						newPic.style.position="absolute";
						
						//help button
						handleDOM.create("help", "IMG", buttons);
						var help=document.getElementById("help");
						help.src="img/help.png";
						help.style.position="absolute";
						
						//set button divs dimensions and coordinates based upon screen ratio
						if((docHeight-(docWidth*picW))/5<=docWidth*picW*.66){
							newCircle.style.left=((picW*docWidth)-((docHeight-(docWidth*picW))/5))/2+'px';
							newCircle.style.top=(docHeight-(picW*docWidth))*.04+'px';
							newCircle.style.width=(docHeight-(docWidth*picW))/5+'px';
							newCircle.style.height=(docHeight-(docWidth*picW))/5+'px';
						
							settings.style.left=((picW*docWidth)-((docHeight-(docWidth*picW))/5))/2+'px';
							settings.style.top=(docHeight-(picW*docWidth))*.08+(docHeight-(docWidth*picW))/5+'px';
							settings.style.width=(docHeight-(docWidth*picW))/5+'px';
							settings.style.height=(docHeight-(docWidth*picW))/5+'px';

							newPic.style.left=((picW*docWidth)-((docHeight-(docWidth*picW))/5))/2+'px';
							newPic.style.top=(docHeight-(picW*docWidth))*.12+(docHeight-(docWidth*picW))*2/5+'px';
							newPic.style.width=(docHeight-(docWidth*picW))/5+'px';
							newPic.style.height=(docHeight-(docWidth*picW))/5+'px';
						
							help.style.left=((picW*docWidth)-((docHeight-(docWidth*picW))/5))/2+'px';
							help.style.top=(docHeight-(picW*docWidth))*.16+(docHeight-(docWidth*picW))*3/5+'px';
							help.style.width=(docHeight-(docWidth*picW))/5+'px';
							help.style.height=(docHeight-(docWidth*picW))/5+'px';
						}
						else{
							newCircle.style.left=docWidth*picW*.16+'px';
							newCircle.style.top=((docHeight-(docWidth*picW))-(docWidth*picW*.66)*4)/5+'px';
							newCircle.style.width=docWidth*picW*.66+'px';
							newCircle.style.height=docWidth*picW*.66+'px';
						
							settings.style.left=docWidth*picW*.16+'px';
							settings.style.top=((docHeight-(docWidth*picW))-(docWidth*picW*.66)*4)*2/5+(docWidth*picW*.66)+'px';
							settings.style.width=docWidth*picW*.66+'px';
							settings.style.height=docWidth*picW*.66+'px';

							newPic.style.left=docWidth*picW*.16+'px';
							newPic.style.top=((docHeight-(docWidth*picW))-(docWidth*picW*.66)*4)*3/5+(docWidth*picW*.66*2)+'px';
							newPic.style.width=docWidth*picW*.66+'px';
							newPic.style.height=docWidth*picW*.66+'px';
						
							help.style.left=docWidth*picW*.16+'px';
							help.style.top=((docHeight-(docWidth*picW))-(docWidth*picW*.66)*4)*4/5+(docWidth*picW*.66*3)+'px';
							help.style.width=docWidth*picW*.66+'px';
							help.style.height=docWidth*picW*.66+'px';
						
						}
			
						
			},
		
		//===================search page=============================
			search: function(em, pw){
				//slide function
				var picW=.225;
				var currentR=0;
				var slideRight2 = function(){
						setTimeout(function(){
							if(currentR<docWidth){
								currentR +=slider;
								if(currentR>.9*docWidth){
									search.style.left=.9*docWidth+'px';
									search.style.width=.1*docWidth+'px';
								}
								else{
									search.style.left=currentR+'px';
									search.style.width=docWidth-currentR+'px';
								}
								slideRight2();
							}
							else if(currentR >= docWidth){
								handleDOM.remove("back");
								page.main(em, pw);
							}
						}, 20);
					}
					
				//pull up search div and create for back button
				var search=document.getElementById("search");
				search.style.height=picW*docWidth+'px';
					handleDOM.create("back", "IMG", search)
					var back=document.getElementById("back");
					back.src="img/back.png";
					back.style.position="relative";
					back.style.width=.075*docWidth+'px';
					back.style.height=.075*docWidth+'px';
					back.style.left=.02*docWidth+'px';
					back.style.top=((picW*docWidth)-(.075*docWidth))*2/5+'px';
					back.onclick=function(){slideRight2()};
			}
		}
		</script>
    </body>
</html>
